

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>5. Plotting bivariate functions in R &#8212; Numerical methods for EC139</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.4cbf315f70debaebd550c87a6162cf0f.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ch5R3Dplotting';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6. Linear algebra in R" href="ch6Matrices.html" />
    <link rel="prev" title="4. Loops in R" href="ch4Loops.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Numerical methods for EC139 - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Numerical methods for EC139 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    <no title>
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ch1Rbasics.html">1. Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch2RPlotting.html">2. 2D Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch3Functions.html">3. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch4Loops.html">4. Loops</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">5. 3D Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch6Matrices.html">6. Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch7Integrals.html">7. Integrals</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/eekostadinov/EC139" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/eekostadinov/EC139/issues/new?title=Issue%20on%20page%20%2Fch5R3Dplotting.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/ch5R3Dplotting.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Plotting bivariate functions in R</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-3d-surface-plot-for-a-function-of-two-variables">5.1. Creating a 3D surface plot for a function of two variables.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1">5.1.1. Step 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2">5.1.2. Step 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3">5.1.3. Step 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#customizing-the-look-of-the-surface-plot">5.1.4. Customizing the look of the surface plot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-contour-plot-for-a-function-of-two-variables">5.2. Creating a contour plot for a function of two variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#so-what-does-outer-x-y-f-do">5.3. So what does <code class="docutils literal notranslate"><span class="pre">outer(x,y,f)</span></code> do?</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="tex2jax_ignore mathjax_ignore section" id="plotting-bivariate-functions-in-r">
<span id="chapter-3dplotting"></span><h1><span class="section-number">5. </span>Plotting bivariate functions in R<a class="headerlink" href="#plotting-bivariate-functions-in-r" title="Permalink to this heading">#</a></h1>
<p>This chapter is a quick guide to plotting 3D surface plots and contour plots for functions of two variables in R. Following the discussion you should be able to plot any simple bivariate function and customise your graph.</p>
<p>All the examples below only use the core functionality of R (available with any installation through the in-built R <code class="docutils literal notranslate"><span class="pre">graphics</span></code> package) and do not require the installation of additional packages.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The discussion builds upon the material from chapters <a class="reference internal" href="ch2RPlotting.html#chapter-plotting"><span class="std std-ref">Plotting in R</span></a> and <a class="reference internal" href="ch3Functions.html#chapter-functions"><span class="std std-ref">Writing your own functions in R</span></a>, so make sure that you have gone through these already.</p>
</div>
<p>The best way to work through the chapter is to read the discussion and then reproduce all code in your own R/RStudio installation. You can do this by copying code from a notebook cell to your R script and run the code line by line.</p>
<p>The chapter includes some exercises that allow you to test your understanding. It is recommended that you try these exercises on your own before choosing the option to reveal the solutions.</p>
<div class="section" id="creating-a-3d-surface-plot-for-a-function-of-two-variables">
<h2><span class="section-number">5.1. </span>Creating a 3D surface plot for a function of two variables.<a class="headerlink" href="#creating-a-3d-surface-plot-for-a-function-of-two-variables" title="Permalink to this heading">#</a></h2>
<p>Conceptually, the procedure for plotting bivariate functions in three dimensions is very similar to the procedure for plotting univariate functions in two dimensions, as discussed in <a class="reference internal" href="ch2RPlotting.html#chapter-plotting"><span class="std std-ref">Plotting in R</span></a>.</p>
<p>In order to set the stage let’s revisit the procedure for plotting functions of one variable. For example, to plot <span class="math notranslate nohighlight">\(y=x^2-1\)</span> for <span class="math notranslate nohighlight">\(x\in[-2,2]\)</span> we follow the following 3-step procedure:</p>
<p><strong>Step 1</strong></p>
<p>Define a vector, <code class="docutils literal notranslate"><span class="pre">x</span></code>, of evenly spaced <span class="math notranslate nohighlight">\(x\)</span> coordinates for <span class="math notranslate nohighlight">\(x\in[-2,2]\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">-2</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="n">by</span><span class="o">=</span><span class="m">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Step 2</strong></p>
<p>Assign the corresponding <span class="math notranslate nohighlight">\(y\)</span> coordinates to <code class="docutils literal notranslate"><span class="pre">y</span></code>. To emphasise the similarity to the procedure for 3D plots, let’s do this by using a function <code class="docutils literal notranslate"><span class="pre">f</span></code> implementing <span class="math notranslate nohighlight">\(f(x)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span><span class="nf">return</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="m">2-1</span><span class="p">)}</span>
<span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Step 3</strong></p>
<p>Plot <code class="docutils literal notranslate"><span class="pre">x</span></code> against <code class="docutils literal notranslate"><span class="pre">y</span></code> using the function <code class="docutils literal notranslate"><span class="pre">plot()</span></code> with the optional argument <code class="docutils literal notranslate"><span class="pre">type=&quot;l&quot;</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/0d5b675127fd1c763915efa2ac06d6fcff72ed80a9496726ddfc2386c6093415.png"><img alt="_images/0d5b675127fd1c763915efa2ac06d6fcff72ed80a9496726ddfc2386c6093415.png" src="_images/0d5b675127fd1c763915efa2ac06d6fcff72ed80a9496726ddfc2386c6093415.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>For plotting surface (3D) plots of bivariate functions we follow logically the same 3-step procedure, with small changes of the syntax.</p>
<p>Suppose that we want to plot the bivariate function <span class="math notranslate nohighlight">\(z=-x^2-y^2\)</span> for <span class="math notranslate nohighlight">\(x\in[-10,10]\)</span> and <span class="math notranslate nohighlight">\(y\in[-10,10]\)</span>.</p>
<div class="section" id="step-1">
<h3><span class="section-number">5.1.1. </span>Step 1<a class="headerlink" href="#step-1" title="Permalink to this heading">#</a></h3>
<p>Define</p>
<ul class="simple">
<li><p>a vector <code class="docutils literal notranslate"><span class="pre">x</span></code> of evenly spaced <span class="math notranslate nohighlight">\(x\)</span>-coordinates for <span class="math notranslate nohighlight">\(x\in[-10,10]\)</span> and</p></li>
<li><p>a vector <code class="docutils literal notranslate"><span class="pre">y</span></code> of evenly spaced <span class="math notranslate nohighlight">\(y\)</span>-coordinates for <span class="math notranslate nohighlight">\(y\in[-10,10]\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">-10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">-10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note that at this step the only difference with respect to <strong>Step 1</strong> for univariate functions, is that now we have two axes for the values of the arguments.</p>
</div>
<div class="section" id="step-2">
<h3><span class="section-number">5.1.2. </span>Step 2<a class="headerlink" href="#step-2" title="Permalink to this heading">#</a></h3>
<p>Assign the corresponding <span class="math notranslate nohighlight">\(z\)</span> coordinates to <code class="docutils literal notranslate"><span class="pre">z</span></code>. As above define a function <code class="docutils literal notranslate"><span class="pre">f</span></code> implementing <span class="math notranslate nohighlight">\(f(x,y)\)</span>. Then create the corresponding <span class="math notranslate nohighlight">\(z\)</span> coordinates by using the code <code class="docutils literal notranslate"><span class="pre">z</span> <span class="pre">&lt;-</span> <span class="pre">outer(x,y,f)</span></code><a class="footnote-reference brackets" href="#id2" id="id1">1</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">){</span><span class="nf">return</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y</span><span class="o">^</span><span class="m">2</span><span class="p">)}</span>
<span class="n">z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">outer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">f</span><span class="p">);</span><span class="w"> </span>
</pre></div>
</div>
</div>
</div>
<p>Note that at this step the only difference with respect to <strong>Step 2</strong> for univariate functions is that we assign the <span class="math notranslate nohighlight">\(z\)</span> coordinates by using the <code class="docutils literal notranslate"><span class="pre">outer()</span></code> function rather than through a direct call to <code class="docutils literal notranslate"><span class="pre">f</span></code></p>
</div>
<div class="section" id="step-3">
<h3><span class="section-number">5.1.3. </span>Step 3<a class="headerlink" href="#step-3" title="Permalink to this heading">#</a></h3>
<p>Plot <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> against <code class="docutils literal notranslate"><span class="pre">z</span></code> using the function <code class="docutils literal notranslate"><span class="pre">persp()</span></code> (for <em>perspective</em>) with usage</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">persp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">...</span></code> denotes optional arguments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">persp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/c4a4d30d9422102a50d08c70e27b5f27089bb917654279a5749274958045f9cb.png"><img alt="_images/c4a4d30d9422102a50d08c70e27b5f27089bb917654279a5749274958045f9cb.png" src="_images/c4a4d30d9422102a50d08c70e27b5f27089bb917654279a5749274958045f9cb.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>Note that at this step the only difference with respect to <strong>Step 3</strong> for univariate functions is that we use <code class="docutils literal notranslate"><span class="pre">persp()</span></code> rather than <code class="docutils literal notranslate"><span class="pre">plot()</span></code>.</p>
<p>And that’s it. For clarity, let’s palce everything in a single code block:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set coordinates for the arguments</span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">-10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">-10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="c1"># Assign corresponding z coordinates</span>
<span class="n">f</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">){</span><span class="nf">return</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y</span><span class="o">^</span><span class="m">2</span><span class="p">)}</span>
<span class="n">z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">outer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">f</span><span class="p">);</span><span class="w"> </span>
<span class="c1"># Plot</span>
<span class="nf">persp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/c4a4d30d9422102a50d08c70e27b5f27089bb917654279a5749274958045f9cb.png"><img alt="_images/c4a4d30d9422102a50d08c70e27b5f27089bb917654279a5749274958045f9cb.png" src="_images/c4a4d30d9422102a50d08c70e27b5f27089bb917654279a5749274958045f9cb.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>By adjusting <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">f</span></code> you can plot the surface of any bivariate function.</p>
</div>
<div class="section" id="customizing-the-look-of-the-surface-plot">
<h3><span class="section-number">5.1.4. </span>Customizing the look of the surface plot<a class="headerlink" href="#customizing-the-look-of-the-surface-plot" title="Permalink to this heading">#</a></h3>
<p>As with <code class="docutils literal notranslate"><span class="pre">plot()</span></code>, when using <code class="docutils literal notranslate"><span class="pre">persp()</span></code> we can customize the look of the graph by using optional arguments.</p>
<p>One important set of optional arguments that are specific to 3D plotting only are ones that allow us to specify the viewing direction - <code class="docutils literal notranslate"><span class="pre">theta</span></code> and <code class="docutils literal notranslate"><span class="pre">phi</span></code>. To understand how these work, imagine that you are on a sphere surrounding the graph and can move along the sphere to change your perspective. The argument <code class="docutils literal notranslate"><span class="pre">theta</span></code> allows you to move along “longitudes” of the sphere, while the argument <code class="docutils literal notranslate"><span class="pre">phi</span></code> allows you to move along “latitudes” of the sphere. The values of both <code class="docutils literal notranslate"><span class="pre">theta</span></code> and <code class="docutils literal notranslate"><span class="pre">phi</span></code> are set in terms of degrees of the angle by which you want to move.</p>
<p>For example, to move your perspective as a viewer by 30 degrees along the longitude type</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">persp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">theta</span><span class="o">=</span><span class="m">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/66868a5f831fff3a78740d3fc0caba8654f88a478126c44d8230e5f1a91f1ae4.png"><img alt="_images/66868a5f831fff3a78740d3fc0caba8654f88a478126c44d8230e5f1a91f1ae4.png" src="_images/66868a5f831fff3a78740d3fc0caba8654f88a478126c44d8230e5f1a91f1ae4.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>Or to move by 30 degrees along the latitude type</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">persp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">phi</span><span class="o">=</span><span class="m">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/fb7521a6a5ef098d946527a774a6027f0b09387182c3eeac5ed68ab738f047f4.png"><img alt="_images/fb7521a6a5ef098d946527a774a6027f0b09387182c3eeac5ed68ab738f047f4.png" src="_images/fb7521a6a5ef098d946527a774a6027f0b09387182c3eeac5ed68ab738f047f4.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>Perhaps a better view involves moving along both longitude and latitude?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">persp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">theta</span><span class="o">=</span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/164f6560a9eb04979c2868d47b75f4d370b23b34cd45988af82db8830c8ada6e.png"><img alt="_images/164f6560a9eb04979c2868d47b75f4d370b23b34cd45988af82db8830c8ada6e.png" src="_images/164f6560a9eb04979c2868d47b75f4d370b23b34cd45988af82db8830c8ada6e.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>We can change the colour of the surface by using <code class="docutils literal notranslate"><span class="pre">col</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">persp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">theta</span><span class="o">=</span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lightblue&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/c659dc16e3ca5aad04f6502ce5e964e0e130d2c5cb6f34227a2a2f4d711b02cd.png"><img alt="_images/c659dc16e3ca5aad04f6502ce5e964e0e130d2c5cb6f34227a2a2f4d711b02cd.png" src="_images/c659dc16e3ca5aad04f6502ce5e964e0e130d2c5cb6f34227a2a2f4d711b02cd.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>We may want to remove the box?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">persp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">theta</span><span class="o">=</span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lightblue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">box</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/e71850501478f90a9393b7885a7cf7b1061215a3b8d3bfad80f18af1fd72cd82.png"><img alt="_images/e71850501478f90a9393b7885a7cf7b1061215a3b8d3bfad80f18af1fd72cd82.png" src="_images/e71850501478f90a9393b7885a7cf7b1061215a3b8d3bfad80f18af1fd72cd82.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>We may want to have <em>ticks</em> along the axes?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">persp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">theta</span><span class="o">=</span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lightblue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ticktype</span><span class="o">=</span><span class="s">&quot;detailed&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/ea275963a1b9435e98d6ecf2439ddaa8bd0074f03fd2030540d5a50579f9fde0.png"><img alt="_images/ea275963a1b9435e98d6ecf2439ddaa8bd0074f03fd2030540d5a50579f9fde0.png" src="_images/ea275963a1b9435e98d6ecf2439ddaa8bd0074f03fd2030540d5a50579f9fde0.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>And so forth.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Of course, you don’t need to remember all these optional arguments. You can simply type <code class="docutils literal notranslate"><span class="pre">?persp</span></code> in the R console to look for the documentation of the function, or find a lot of online resources that discuss 3D plotting with <code class="docutils literal notranslate"><span class="pre">persp()</span></code> in detail.</p>
</div>
<div class="exercise admonition" id="ex-surf">

<p class="admonition-title"><span class="caption-number">Exercise 5.1 </span></p>
<div class="section" id="exercise-content">
<p>The figure below is a surface plot of <span class="math notranslate nohighlight">\(f(x,y)=x^2-y^2\)</span> for <span class="math notranslate nohighlight">\(x\in[-10,10]\)</span> and <span class="math notranslate nohighlight">\(y\in[-10,10]\)</span>.</p>
<p>The viewing direction is specified as <code class="docutils literal notranslate"><span class="pre">theta=30,</span> <span class="pre">phi=30</span></code>.</p>
<img alt="_images/fig-surface.png" src="_images/fig-surface.png" />
<p>Reproduce the graph in your RStudio.</p>
</div>
</div>
<div class="solution dropdown admonition" id="ch5R3Dplotting-solution-1">

<p class="admonition-title">Solution to<a class="reference internal" href="#ex-surf"> Exercise 5.1</a></p>
<div class="section" id="solution-content">
<p>The figure was generated with the following code</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="n">seq</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">by</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="n">y</span> <span class="o">&lt;-</span> <span class="n">seq</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">by</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="n">f</span> <span class="o">&lt;-</span> <span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)}</span>
<span class="n">z</span> <span class="o">&lt;-</span> <span class="n">outer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>
<span class="n">persp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;lightblue&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="creating-a-contour-plot-for-a-function-of-two-variables">
<h2><span class="section-number">5.2. </span>Creating a contour plot for a function of two variables<a class="headerlink" href="#creating-a-contour-plot-for-a-function-of-two-variables" title="Permalink to this heading">#</a></h2>
<p>As seen in the lectures, a very useful type of graphical representation of functions of two variables is the contour plot.</p>
<p>The good news is that once you are familiar with the procedure of making surface plots, contour plots are straightforward to implement with R.</p>
<p>For example, consider the function</p>
<div class="math notranslate nohighlight">
\[
z=-x^2-y^2
\]</div>
<p>whose surface we plotted above for <span class="math notranslate nohighlight">\(x\in[-10,10]\)</span> and <span class="math notranslate nohighlight">\(y\in[-10,10]\)</span> by using the code</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="n">seq</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">&lt;-</span> <span class="n">seq</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">f</span> <span class="o">&lt;-</span> <span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)}</span>
<span class="n">z</span> <span class="o">&lt;-</span> <span class="n">outer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">f</span><span class="p">);</span> 
<span class="n">persp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
<p>In order to plot the contour plot for the same function for <span class="math notranslate nohighlight">\(x\in[-10,10]\)</span> and <span class="math notranslate nohighlight">\(y\in[-10,10]\)</span>, we use exactly the same code, except that instead of plotting by calling <code class="docutils literal notranslate"><span class="pre">persp(x,y,z)</span></code> we call <code class="docutils literal notranslate"><span class="pre">contour(x,y,z)</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">-10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">-10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="n">f</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">){</span><span class="nf">return</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y</span><span class="o">^</span><span class="m">2</span><span class="p">)}</span>
<span class="n">z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">outer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">f</span><span class="p">);</span><span class="w"> </span>
<span class="nf">contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/5657366cbfa26f3655efdb1eeb4500cf862faf22aa294185e843006110cbc115.png"><img alt="_images/5657366cbfa26f3655efdb1eeb4500cf862faf22aa294185e843006110cbc115.png" src="_images/5657366cbfa26f3655efdb1eeb4500cf862faf22aa294185e843006110cbc115.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>The plot can be customized by using optional arguments. For example, to change the color of the contours</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/479d00977ab25913dd0ecb20812aac33877ef5b91e943194e63c1b8af4e14b50.png"><img alt="_images/479d00977ab25913dd0ecb20812aac33877ef5b91e943194e63c1b8af4e14b50.png" src="_images/479d00977ab25913dd0ecb20812aac33877ef5b91e943194e63c1b8af4e14b50.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>To make the contour lines thicker</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/b50b67fde7ede256f8a3616cf1048a0aef870e6321228b1087ff5ab40ba77638.png"><img alt="_images/b50b67fde7ede256f8a3616cf1048a0aef870e6321228b1087ff5ab40ba77638.png" src="_images/b50b67fde7ede256f8a3616cf1048a0aef870e6321228b1087ff5ab40ba77638.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>To change the number of contours plotted</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">nlevels</span><span class="o">=</span><span class="m">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/3fc5a4bc6f6ae7da08892e7e87b8d8f9ed06d768c2ce9cf7f47702647a81492e.png"><img alt="_images/3fc5a4bc6f6ae7da08892e7e87b8d8f9ed06d768c2ce9cf7f47702647a81492e.png" src="_images/3fc5a4bc6f6ae7da08892e7e87b8d8f9ed06d768c2ce9cf7f47702647a81492e.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>We can also plot a contour plot with the areas between the contours filled in solid color, instead of <code class="docutils literal notranslate"><span class="pre">contour()</span></code> use the function <code class="docutils literal notranslate"><span class="pre">filled.contour()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">filled.contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/061cccc483145b04efe733bb972c7a4127d62716fb177d76fd4a0b9700e77ef3.png"><img alt="_images/061cccc483145b04efe733bb972c7a4127d62716fb177d76fd4a0b9700e77ef3.png" src="_images/061cccc483145b04efe733bb972c7a4127d62716fb177d76fd4a0b9700e77ef3.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>An interesting (if a bit indulgent) feature is that with filled contours we can use color palettes (note that by default we have a lot of colors in such a plot so it is no longer sufficient to define the color, but the whole “color palette”). R has a number of in-built palettes which can be called as below (if you are interested check online how to do this).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">filled.contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cm.colors</span><span class="p">(</span><span class="m">20</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/7ac69e0024120223263c5f1222b9e6813d17eff3d98ee03ec4e5224a913cf8ae.png"><img alt="_images/7ac69e0024120223263c5f1222b9e6813d17eff3d98ee03ec4e5224a913cf8ae.png" src="_images/7ac69e0024120223263c5f1222b9e6813d17eff3d98ee03ec4e5224a913cf8ae.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">filled.contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rainbow</span><span class="p">(</span><span class="m">20</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/633bc799f32b5dbd33d417cc265762f6873422d7229184ee520c0ac54f410406.png"><img alt="_images/633bc799f32b5dbd33d417cc265762f6873422d7229184ee520c0ac54f410406.png" src="_images/633bc799f32b5dbd33d417cc265762f6873422d7229184ee520c0ac54f410406.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>We can even use palettes with colors from Wes Anderson movies (if you haven’t watched any I highly recommend them) but they come with an additional package that needs to be installed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">install</span><span class="o">.</span><span class="n">packages</span><span class="p">(</span><span class="s2">&quot;wesanderson&quot;</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">wesanderson</span><span class="p">)</span>
</pre></div>
</div>
<p>And here is a filled contour with colors from the Wes Anderson’s “Grand Budapest Hotel”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">filled.contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">wes_palette</span><span class="p">(</span><span class="s">&quot;GrandBudapest2&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;continuous&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/0dac23141066308b0b21d0ead6ece334e4eb02a2da31ddc74b09ddf7a92269d6.png"><img alt="_images/0dac23141066308b0b21d0ead6ece334e4eb02a2da31ddc74b09ddf7a92269d6.png" src="_images/0dac23141066308b0b21d0ead6ece334e4eb02a2da31ddc74b09ddf7a92269d6.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>Anyhow, this is not so important. The important point is that it is very easy to make contour plots in R.</p>
<div class="exercise admonition" id="ex-cont">

<p class="admonition-title"><span class="caption-number">Exercise 5.2 </span></p>
<div class="section" id="exercise-content">
<p>Consider the utility function <span class="math notranslate nohighlight">\(u(x,y)=x^{1/3}y^{2/3}\)</span>.</p>
<p>Produce a simple graph of indifference curves from this utility function for <span class="math notranslate nohighlight">\(x\in[0,3]\)</span> and <span class="math notranslate nohighlight">\(y\in[0,3]\)</span></p>
</div>
</div>
<div class="solution dropdown admonition" id="ch5R3Dplotting-solution-3">

<p class="admonition-title">Solution to<a class="reference internal" href="#ex-cont"> Exercise 5.2</a></p>
<div class="section" id="solution-content">
<p>A graph of indifference curves (indifference map) is nothing else but a contour plot of a utility function. Hence the code below produces such indifference map</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="n">seq</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">by</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">&lt;-</span> <span class="n">seq</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">by</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">f</span> <span class="o">&lt;-</span> <span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">){</span><span class="k">return</span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)))}</span>
<span class="n">z</span> <span class="o">&lt;-</span> <span class="n">outer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">f</span><span class="p">);</span> 
<span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/fig-contourplot.png" src="_images/fig-contourplot.png" />
</div>
</div>
</div>
<div class="section" id="so-what-does-outer-x-y-f-do">
<h2><span class="section-number">5.3. </span>So what does <code class="docutils literal notranslate"><span class="pre">outer(x,y,f)</span></code> do?<a class="headerlink" href="#so-what-does-outer-x-y-f-do" title="Permalink to this heading">#</a></h2>
<p>As seen above, a key step in producing plots of a bivariate functions is defining appropriate set of <span class="math notranslate nohighlight">\(z\)</span> coordinates corresponding to the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> coordinates. Further, whether we produce surface plots or contour plots, given vectors of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> coordinates and a specification of the function to be plotted <span class="math notranslate nohighlight">\(f\)</span>, these coordinates are defined consistently by the statement <code class="docutils literal notranslate"><span class="pre">z</span> <span class="pre">&lt;-</span> <span class="pre">outer(x,y,f)</span></code>. In this section we turn attention to the <code class="docutils literal notranslate"><span class="pre">outer()</span></code> function and to understanding exactly what it does.</p>
<p>To set the stage, consider first a plot of a univariate function in two dimensions. For example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">-2</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="n">by</span><span class="o">=</span><span class="m">0.25</span><span class="p">)</span>
<span class="n">f</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span><span class="nf">return</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="m">2-1</span><span class="p">)}</span>
<span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/0d5b675127fd1c763915efa2ac06d6fcff72ed80a9496726ddfc2386c6093415.png"><img alt="_images/0d5b675127fd1c763915efa2ac06d6fcff72ed80a9496726ddfc2386c6093415.png" src="_images/0d5b675127fd1c763915efa2ac06d6fcff72ed80a9496726ddfc2386c6093415.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>Notice that in the case of a bivariate function both the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> coordinates are specified as vectors of the same number of elements</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>-2</li><li>-1.75</li><li>-1.5</li><li>-1.25</li><li>-1</li><li>-0.75</li><li>-0.5</li><li>-0.25</li><li>0</li><li>0.25</li><li>0.5</li><li>0.75</li><li>1</li><li>1.25</li><li>1.5</li><li>1.75</li><li>2</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">17</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>3</li><li>2.0625</li><li>1.25</li><li>0.5625</li><li>0</li><li>-0.4375</li><li>-0.75</li><li>-0.9375</li><li>-1</li><li>-0.9375</li><li>-0.75</li><li>-0.4375</li><li>0</li><li>0.5625</li><li>1.25</li><li>2.0625</li><li>3</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">length</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">17</div></div>
</div>
<p>because a univariate function maps a value of <span class="math notranslate nohighlight">\(x\)</span> into a unique value of <span class="math notranslate nohighlight">\(y\)</span>. For each <span class="math notranslate nohighlight">\(x\)</span> there is exactly one <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>However, in the case of plotting bivariate functions we use vectors of <span class="math notranslate nohighlight">\(x\)</span> coordinates and <span class="math notranslate nohighlight">\(y\)</span> coordinates to specify the values of the arguments at which to plot, and another set of <span class="math notranslate nohighlight">\(z\)</span> coordinates to specify the values of the function at each pair of combinations of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> coordinates. A bivariate function maps each combination of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> into a value for <span class="math notranslate nohighlight">\(z\)</span> and therefore we need to specify a <span class="math notranslate nohighlight">\(z\)</span> coordinate for each combination of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. For example, consider the plot below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set coordinates for the arguments</span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">-5</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">-5</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="c1"># Assign corresponding z coordinates</span>
<span class="n">f</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">){</span><span class="nf">return</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y</span><span class="o">^</span><span class="m">2</span><span class="p">)}</span>
<span class="n">z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">outer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">f</span><span class="p">);</span><span class="w"> </span>
<span class="c1"># Plot</span>
<span class="nf">persp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/0b96f12a1d829c05b4b4a36e1a82d529b253f39aad6a59e15bb59d47bef7cd66.png"><img alt="_images/0b96f12a1d829c05b4b4a36e1a82d529b253f39aad6a59e15bb59d47bef7cd66.png" src="_images/0b96f12a1d829c05b4b4a36e1a82d529b253f39aad6a59e15bb59d47bef7cd66.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>The vectors <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> have 21 elements each.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>-5</li><li>-4</li><li>-3</li><li>-2</li><li>-1</li><li>0</li><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">11</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>-5</li><li>-4</li><li>-3</li><li>-2</li><li>-1</li><li>0</li><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">length</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">11</div></div>
</div>
<p>So an appropriate set of <span class="math notranslate nohighlight">\(z\)</span> coordinates will include one <span class="math notranslate nohighlight">\(z\)</span> coordinate for each combination of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. Since there are 11 values for <span class="math notranslate nohighlight">\(x\)</span> and 11 values for <span class="math notranslate nohighlight">\(y\)</span>, we need to have <span class="math notranslate nohighlight">\(11\times 11=121\)</span> <span class="math notranslate nohighlight">\(z\)</span> coordinates. Further, these coordinates need to be specified in a consistent way so that R knows which of the 121 <span class="math notranslate nohighlight">\(z\)</span> coordinates corresponds to which combination of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. This is exactly what <code class="docutils literal notranslate"><span class="pre">outer(x,y,f)</span></code> does.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">outer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>
<span class="n">z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A matrix: 11 × 11 of type dbl</caption>
<tbody>
	<tr><td>-50</td><td>-41</td><td>-34</td><td>-29</td><td>-26</td><td>-25</td><td>-26</td><td>-29</td><td>-34</td><td>-41</td><td>-50</td></tr>
	<tr><td>-41</td><td>-32</td><td>-25</td><td>-20</td><td>-17</td><td>-16</td><td>-17</td><td>-20</td><td>-25</td><td>-32</td><td>-41</td></tr>
	<tr><td>-34</td><td>-25</td><td>-18</td><td>-13</td><td>-10</td><td> -9</td><td>-10</td><td>-13</td><td>-18</td><td>-25</td><td>-34</td></tr>
	<tr><td>-29</td><td>-20</td><td>-13</td><td> -8</td><td> -5</td><td> -4</td><td> -5</td><td> -8</td><td>-13</td><td>-20</td><td>-29</td></tr>
	<tr><td>-26</td><td>-17</td><td>-10</td><td> -5</td><td> -2</td><td> -1</td><td> -2</td><td> -5</td><td>-10</td><td>-17</td><td>-26</td></tr>
	<tr><td>-25</td><td>-16</td><td> -9</td><td> -4</td><td> -1</td><td>  0</td><td> -1</td><td> -4</td><td> -9</td><td>-16</td><td>-25</td></tr>
	<tr><td>-26</td><td>-17</td><td>-10</td><td> -5</td><td> -2</td><td> -1</td><td> -2</td><td> -5</td><td>-10</td><td>-17</td><td>-26</td></tr>
	<tr><td>-29</td><td>-20</td><td>-13</td><td> -8</td><td> -5</td><td> -4</td><td> -5</td><td> -8</td><td>-13</td><td>-20</td><td>-29</td></tr>
	<tr><td>-34</td><td>-25</td><td>-18</td><td>-13</td><td>-10</td><td> -9</td><td>-10</td><td>-13</td><td>-18</td><td>-25</td><td>-34</td></tr>
	<tr><td>-41</td><td>-32</td><td>-25</td><td>-20</td><td>-17</td><td>-16</td><td>-17</td><td>-20</td><td>-25</td><td>-32</td><td>-41</td></tr>
	<tr><td>-50</td><td>-41</td><td>-34</td><td>-29</td><td>-26</td><td>-25</td><td>-26</td><td>-29</td><td>-34</td><td>-41</td><td>-50</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>As you can see <code class="docutils literal notranslate"><span class="pre">outer(x,y,f)</span></code> specifies the <span class="math notranslate nohighlight">\(z\)</span>-coordinates into a <em>matrix</em> (a two-dimensional array) where the element in (row <span class="math notranslate nohighlight">\(i\)</span>, column <span class="math notranslate nohighlight">\(j\)</span>) corresponds to the value of the function when <span class="math notranslate nohighlight">\(x\)</span> equals the <span class="math notranslate nohighlight">\(i\)</span>’th element of <code class="docutils literal notranslate"><span class="pre">x</span></code> and <span class="math notranslate nohighlight">\(y\)</span> equals the <span class="math notranslate nohighlight">\(j\)</span>’th element to <code class="docutils literal notranslate"><span class="pre">y</span></code>. For example, the 3rd element of <code class="docutils literal notranslate"><span class="pre">x</span></code> is -3 and the 4th element of <code class="docutils literal notranslate"><span class="pre">y</span></code> is -2. The value of the function when <span class="math notranslate nohighlight">\(x=-3\)</span> and <span class="math notranslate nohighlight">\(y=-2\)</span> is <span class="math notranslate nohighlight">\(f(-3,-2)=-(-3)^2-(-2)^2=-13\)</span>. As we can see the element of <code class="docutils literal notranslate"><span class="pre">z</span></code> in (row 3, column 4) is exactly -13.</p>
<p>Hence, based on this orderly specification of <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span> coordinates, R knows exactly what value of <span class="math notranslate nohighlight">\(z\)</span> corresponds to each pair of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>, and is able to plot.</p>
<p>This completes the discussion of <a class="reference internal" href="#chapter-3dplotting"><span class="std std-ref">Plotting bivariate functions in R</span></a>. We next turn attention to using R for working with matrices.</p>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>At this stage don’t worry about what the <code class="docutils literal notranslate"><span class="pre">outer()</span></code> function does - we will look at this soon. For now just keep in mind that this is always the correct piece of code needed to generate corresponding <code class="docutils literal notranslate"><span class="pre">z</span></code> coordinates from vectors <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> and a function <code class="docutils literal notranslate"><span class="pre">f</span></code>.</p>
</dd>
</dl>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="ch4Loops.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Loops in R</p>
      </div>
    </a>
    <a class="right-next"
       href="ch6Matrices.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Linear algebra in R</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-3d-surface-plot-for-a-function-of-two-variables">5.1. Creating a 3D surface plot for a function of two variables.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1">5.1.1. Step 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2">5.1.2. Step 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3">5.1.3. Step 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#customizing-the-look-of-the-surface-plot">5.1.4. Customizing the look of the surface plot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-contour-plot-for-a-function-of-two-variables">5.2. Creating a contour plot for a function of two variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#so-what-does-outer-x-y-f-do">5.3. So what does <code class="docutils literal notranslate"><span class="pre">outer(x,y,f)</span></code> do?</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Emil Kostadinov
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>